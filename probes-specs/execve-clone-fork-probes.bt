
tracepoint:syscalls:sys_enter_fork
{
  @start_fork[tid] = nsecs;
}

tracepoint:syscalls:sys_exit_fork / @start_fork[tid] /
{
  $end_fork = nsecs;
  printf("[%d, %d, %lld, %lld] fork\n", pid, tid, @start_fork[tid], $end_fork);
  delete(@start_fork[tid]);
}

tracepoint:syscalls:sys_enter_clone 
{
  @start_clone[tid] = nsecs;
}

tracepoint:syscalls:sys_exit_clone / @start_clone[tid] /
{
  $end_clone = nsecs;
  printf("[%d, %d, %d, %lld, %lld] clone\n", retval, pid, tid, @start_clone[tid], $end_clone);
  delete(@start_clone[tid]);
}

tracepoint:syscalls:sys_enter_execve 
{
  @start_execve[tid] = nsecs;
  @exec_filename[tid] = str(args->filename);
}

tracepoint:syscalls:sys_exit_execve / @start_execve[tid] /
{
  $end_execve = nsecs;
  printf("[%d, %d, %lld, %lld] execve: %s\n", pid, tid, @start_execve[tid], $end_execve, @exec_filename[tid]);
  delete(@start_execve[tid]);
  delete(@exec_filename[tid]);
}