tracepoint:syscalls:sys_enter_clone / comm == str($1) /
{
  @start_clone[comm] = nsecs;
  @count_clone_exit[comm] = 0;
}

tracepoint:syscalls:sys_exit_clone / @start_clone[comm] /
{
  $end_clone = nsecs;
  @count_clone_exit[comm]++;
  if(args->ret == 0) {
    @clone_child_pid[@start_clone[comm]] = pid;
    @clone_child_endts[@start_clone[comm]] = $end_clone;
    
  } else {
    @clone_father_pid[@start_clone[comm]] = pid;
    @clone_father_ret[@start_clone[comm]] = args->ret;
    @clone_father_endts[@start_clone[comm]] = $end_clone;
    
  } 
  if(@count_clone_exit[comm] == 2) {
    delete(@start_clone[comm]);
    delete(@count_clone_exit[comm]);
  }
}

tracepoint:syscalls:sys_enter_execve / str(args->filename) == str($2) /
{
  @start_execve[tid] = nsecs;
  @exec_filename[tid] = str(args->filename);
}

tracepoint:syscalls:sys_exit_execve / @start_execve[tid] /
{
  $end_execve = nsecs;
  @exec_pid[@start_execve[tid]] = pid;
  @exec_endts[@start_execve[tid]] = $end_execve;
  
  delete(@start_execve[tid]);
  delete(@exec_filename[tid]);
}