BEGIN
{
	printf("[%lld] Start BPFTrace\n", nsecs);
}

tracepoint:syscalls:sys_enter_execve 
{
  @start_execve[tid] = nsecs;
  @exec_filename[tid] = str(args->filename);
}

tracepoint:syscalls:sys_exit_execve / @start_execve[tid] /
{
  printf("[%lld] -- [%d] execve: %s\n", nsecs, nsecs - @start_execve[tid], @exec_filename[tid]);
  delete(@start_execve[tid]);
  delete(@exec_filename[tid]);
}

tracepoint:syscalls:sys_enter_clone 
{
  @start_clone[tid] = nsecs;
}

tracepoint:syscalls:sys_exit_clone / @start_clone[tid] /
{
  printf("[%lld] -- [%d] clone\n", nsecs, nsecs - @start_clone[tid]);
  delete(@start_clone[tid]);
}